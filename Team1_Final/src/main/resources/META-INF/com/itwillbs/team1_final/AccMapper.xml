<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.team1_final.mapper.AccMapper">

<!-- 거래처 등록 -->
<insert id="insertAcc">
	INSERT INTO acc
		VALUES (
			CONCAT(#{BUSINESS_NO1},'-',#{BUSINESS_NO2},'-',#{BUSINESS_NO3})
			,#{CUST_NAME}
			,#{BOSS_NAME}
			,#{UPTAE}
			,#{JONGMOK}
			,<choose>
				<when test="TEL1 == ''">
					''
				</when>
				<when test="TEL != ''">
					CONCAT(#{TEL1},'-',#{TEL2},'-',#{TEL3})
				</when>
			</choose>
			,
			<choose>
				<when test="EMAIL1 == ''">
					''
				</when>
				<otherwise>
					CONCAT(#{EMAIL1},'@',#{EMAIL2})
				</otherwise>
			</choose>
			,#{POST_NO}
			,
			<choose>
				<when test="ADDR1 == ''">
					''	
				</when>
				<otherwise>
					CONCAT(#{ADDR1},',',#{ADDR2})
				</otherwise>
				</choose>
			,#{G_GUBUN}
			,#{FAX}
			,
			<choose>
				<when test="MOBILE_NO1 == ''">
					''
				</when>
				<otherwise>
					CONCAT(#{MOBILE_NO1},'-',#{MOBILE_NO2},'-',#{MOBILE_NO3})
				</otherwise>
			</choose>
			,#{URL_PATH}
			,#{MAN_NAME}
			,
			<choose>
				<when test="MAN_TEL == ''">
					''
				</when>
				<otherwise>
					CONCAT(#{MAN_TEL1},'-',#{MAN_TEL2},'-',#{MAN_TEL3})
				</otherwise>
			</choose>
			,
			<choose>
				<when test="MAN_EMAIL1 == ''">
					''
				</when>
				<otherwise>
					CONCAT(#{MAN_EMAIL1},'@',#{MAN_EMAIL2})
				</otherwise>
			</choose>
			,#{REMARKS}
		)
</insert>

<!-- 거래처 목록 조회 -->
	<select id="accList" resultType="com.itwillbs.team1_final.vo.AccVO">
	SELECT * 
			FROM acc -- 이후 작업 분기 일어남 
			<!-- 
			조건에 따른 SQL 구문을 실행하기 위해서는
			choose, when, otherwise 태그를 사용하여 복수개의 조건 판별(if ~ else if 문 구조)
			 -->
			 
			 <!-- 1. 검색어(keyword) 가 널스트링이 아닐 때 검색어 추가 수행, 아니면 검색어 생략-->
			 <!-- => 조건이 하나일 경우 if 태그를 사용하여 단일 조건 판별(if 문 구조) -->
<!-- 			 <if test="!keyword.equals('')"> -->
<!-- 			 	WHERE -->
<!-- 					2. 검색타입(searchType) 에 따른 WHERE 대상 변경 		 -->
<!-- 					=> 조건이 복수개이므로 choose 태그 사용 -->
<!-- 					<choose> -->
<!-- 						<when test="searchType.equals('subject')"> -->
<!-- 							board_subject LIKE '%${keyword}%' -->
<!-- 						</when> -->
<!-- 						<when test="searchType.equals('content')"> -->
<!-- 							board_content LIKE '%${keyword}%' -->
<!-- 						</when> -->
<!-- 						<when test="searchType.equals('subject_content')"> -->
<!-- 							board_subject LIKE '%${keyword}' -->
<!-- 							OR board_content LIKE '%${keyword}%' -->
<!-- 						</when> -->
<!-- 						<when test="searchType.equals('name')"> -->
<!-- 							board_name LIKE '%${keyword}%' -->
<!-- 						</when> -->
<!-- 					</choose> -->
<!-- 			 </if> -->
<!-- 			 ORDER BY CUST_NAME DESC -->
	</select>
	
	<select id="accView" resultType="com.itwillbs.team1_final.vo.AccVO">
		SELECT
			*
			FROM acc
				WHERE BUSINESS_NO = #{BUSINESS_NO}
	</select>
	
	<!-- 거래처 삭제 --> 
	<delete id="accDelete" >
		DELETE
			FROM acc
				WHERE BUSINESS_NO = #{BUSINESS_NO}
	</delete>
	
	<update id="accModify">
		UPDATE acc
			SET
				CUST_NAME = #{CUST_NAME}
				,BOSS_NAME = #{BOSS_NAME}
				,UPTAE = #{UPTAE}
				,JONGMOK = #{JONGMOK}
				,TEL = CONCAT(#{TEL1},'-',#{TEL2},'-',#{TEL3})
				,EMAIL = CONCAT(#{EMAIL1},'@',#{EMAIL2})
				,POST_NO = #{POST_NO}
				,ADDR = CONCAT(#{ADDR1},',',#{ADDR2})
				,G_GUBUN = #{G_GUBUN}
				,FAX = #{FAX}
				,MOBILE_NO = CONCAT(#{MOBILE_NO1},'-',#{MOBILE_NO2},'-',#{MOBILE_NO3})
				,MAN_NAME = #{MAN_NAME}
				,MAN_TEL = CONCAT(#{MAN_TEL1},'-',#{MAN_TEL2},'-',#{MAN_TEL3})
				,MAN_EMAIL = CONCAT(#{MAN_EMAIL1},'@',#{MAN_EMAIL2})
				,REMARKS = #{REMARKS}
				WHERE BUSINESS_NO = #{BUSINESS_NO}
	</update>
	
</mapper>














